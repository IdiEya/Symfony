<!doctype html>
<html class="no-js" lang="en">

    <head>
        <!-- meta data -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Les 3 meta tags doivent être placés en premier dans le head -->
{% block css %}
    <!-- Font-family -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Rufina:400,700" rel="stylesheet">
        
    <!-- Title of site -->
    <title>{% block title %} CarVilla {% endblock %}</title>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/icon" href="{{ asset('assets/front/assets/logo/favicon.png') }}"/>

    <!-- Font-awesome et autres icônes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <!-- Autres CSS personnalisés ou de plugins -->
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/linearicons.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/flaticon.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/animate.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/owl.carousel.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/owl.theme.default.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/bootsnav.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/style.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/front/assets/css/responsive.css') }}">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
{% endblock %}

        <!-- HTML5 shim and Respond.js for IE8 support (facultatif) -->
        <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>
	
	<body>
		<!--[if lte IE 9]>
            <p class="browserupgrade">Vous utilisez un navigateur <strong>obsolète</strong>. Merci de <a href="https://browsehappy.com/">mettre à jour votre navigateur</a> pour améliorer votre expérience et votre sécurité.</p>
        <![endif]-->
	
		<!-- Welcome Hero -->
		  <section id="home" class="welcome-hero">
    {% block body %}
    <div class="top-area" style=" background-color: #e1bee7 ;">
        <div class="header-area" style=" background-color: #e1bee7 ;">
            <!-- Navbar Bootstrap 5 -->
           <nav class="navbar navbar-expand-lg navbar-light navbar-sticky navbar-scrollspy" 
     style="background-color: #e1bee7 ;">
                <div class="container" style="display: flex; align-items: center;">
                    <!-- Logo à gauche -->
                  <img src="{{ asset('img/GYM.png') }}" class="img-fluid logo-lg" alt="logo" style="display:block; width:150px; length:200px;">
                    
                    <!-- Bouton de toggler pour mobile -->
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu" 
                        aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <!-- Menu à droite du logo -->
                    <div class="collapse navbar-collapse" id="navbar-menu">
                        <ul class="navbar-nav ms-auto" style="display: flex; gap: 20px;">
     <li class="nav-item">
        <a class="nav-link" href="{{ path('app_produituser_index') }}">Produits</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{{ path('app_commandeuser_index') }}">Panier</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{{ path('app_client_events') }}"> Evenement</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{{ path('app_mes_participations') }}">Participations</a>
    </li>
  
       <li class="nav-item">
    <a class="nav-link" href="{{ path('app_reserver') }}"> Cours</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{{ path('app_coach1_index') }}"> Coachs</a></li>
    <li class="nav-item">
        <a class="nav-link" href="{{ path('planning_index') }}">Planning</a>
    </li>
                    </div>
                </div>
            </nav>
        </div>
        <div class="clearfix"></div>
    </div>

			<!-- Fin top-area -->

	<div style="length:3000px;" >
  <div  style="background-image: url('{{ asset('img/GYM4.jpeg') }}'); width:1500px;   height:600px; background-size: cover; background-position: center; padding: 100px; color: white;">
   <h2 style="font-size: 3em; margin: 0 auto 30px; max-width: 800px; text-align: center; color: black;">
    GymTown t’accompagne à chaque étape de ton parcours sportif !
</h2>
<p style="font-size: 1.5em; max-width: 1000px; line-height: 1.6; margin: 0 auto; text-align: center; color: black;">
    Bienvenue sur GymTown, l’univers où le sport prend vie ! Réserve tes cours, découvre des coachs passionnés, explore des salles équipées et plonge dans une expérience sportive unique — tout cela en un seul clic.
</p>
  </div>
</div>



		</section>
		<!-- Fin Welcome Hero -->

		<!-- Section produits -->
		<div class="container py-5" style="margin-top:300px;">
		    <!-- En-tête avec titre et bouton d'ajout -->
		    <div class="d-flex justify-content-between align-items-center mb-4">
		        <h1 class="h3 mb-0"><i class="fas fa-boxes me-2"></i>Nos produits</h1>
		    </div>

   <li class="pc-h-item d-none d-md-inline-flex">
      <form class="header-search">
        <i data-feather="search" class="icon-search"></i>
         <input type="text" id="searchAll" placeholder="Recherche par nom, référence ou catégorie ...." class="form-control mb-2" style="width:500px;">
      </form>
    </li>

<li class="nav-item">
        <form method="get" action="{{ path('app_produituser_index') }}" class="mb-4">
            <div class="row g-2 align-items-center">
                <div class="col-auto">
                      
                
                <div class="col-auto">
                    <select name="categorie" id="categorie" class="form-select" onchange="this.form.submit()">
                        <option value="">Toutes les catégories</option>
                        {% for categorie in categories %}
                            <option value="{{ categorie.id }}" {% if categorie.id == selectedCategorie %}selected{% endif %}>
                                {{ categorie.nom }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                </div>
            </div>
        </form>
    </li>

		    <!-- Grille de produits -->
		    <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4" id="productTable">
		        {% for produit in produits %}
		        <div class="col">
		            <div class="card h-100 shadow-sm">
		                <!-- Image du produit -->
		                {% if produit.photo %}
		                <img src="{{ asset('uploads/photos/' ~ produit.photo) }}" 
		                     class="card-img-top p-3" 
		                     alt="{{ produit.nom }}"
		                     style="height: 250px; object-fit: contain;">
		                {% else %}
		                <div class="text-center bg-light p-3" style="height: 250px;">
		                    <i class="fas fa-image fa-5x text-muted mt-5"></i>
		                </div>
		                {% endif %}

		                <div class="card-body">
		                    <!-- Titre et prix -->
		                    <h5 class="card-title">{{ produit.nom }}</h5>
		                    <h6 class="text-primary mb-3">
		                        {{ produit.prix|number_format(2, ',', ' ') }} DT
		                    </h6>

		                    <!-- Détails -->
		                    <div class="d-flex justify-content-between small mb-2">
		                        <span class="text-muted">
		                            <i class="fas fa-barcode me-1"></i>{{ produit.ref }}
		                        </span>
		                        <span class="badge {{ produit.quantite > 0 ? 'bg-success' : 'bg-danger' }}">
		                            {{ produit.quantite }} en stock
		                        </span>
		                    </div>

		                    <!-- Boutons d'action -->
		                    <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-3">
		                        <button class="btn btn-info show-modal-btn" 
		                            data-url="{{ path('produit_modal_show', {'id': produit.id}) }}"
		                            onclick="showProductDetails(this)">
		                            <i class="fas fa-eye"></i>
		                        </button>
		                        <!-- Bouton pour passer une commande -->
		              <!-- Bouton pour passer une commande -->
<button class="btn btn-sm btn-outline-success {% if produit.quantite < 1 %}disabled{% endif %}" 
    title="Commander" 
    data-url="{{ path('app_commande_new', { produitId: produit.id }) }}"
    onclick="orderProduct(this)">
    <i class="fas fa-shopping-cart"></i>
</button>


		                    </div>
		                </div>
		            </div>
		        </div>
		        {% else %}
		        <div class="col-12">
		            <div class="alert alert-info text-center">
		                <i class="fas fa-info-circle me-2"></i>Aucun produit trouvé
		            </div>
		        </div>
		        {% endfor %}
		    </div>
		</div>

		<!-- Modal de suppression -->
		<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header bg-danger text-white">
		                <h5 class="modal-title">
		                    <i class="fas fa-exclamation-triangle me-2"></i>Confirmer la suppression
		                </h5>
		                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		            </div>
		            <div class="modal-body">
		                Êtes-vous sûr de vouloir supprimer définitivement ce produit ?
		            </div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
		                    <i class="fas fa-times me-2"></i>Annuler
		                </button>
		                <form method="post" action="" class="d-inline">
		                    <input type="hidden" name="_method" value="DELETE">
		                    <input type="hidden" name="_token" value="">
		                    <button type="submit" class="btn btn-danger">
		                        <i class="fas fa-trash me-2"></i>Supprimer
		                    </button>
		                </form>
		            </div>
		        </div>
		    </div>
		</div>

		{% for message in app.flashes('error') %}
		    <div class="alert alert-danger">
		        {{ message }}
		    </div>
		{% endfor %}

	

		<!-- Modal Show pour le détail du produit -->
		<div class="modal fade" id="showProductModal" tabindex="-1" aria-labelledby="showProductModalLabel" aria-hidden="true">
		    <div class="modal-dialog modal-xl modal-dialog-centered">
		        <div class="modal-content">
		            <div class="modal-header" style="background-color:rgb(195, 177, 229);">
		                <h5 class="modal-title">
		                    <i class="fas fa-eye me-2"></i>Détails du Produit
		                </h5>
		                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		            </div>
		            <div class="modal-body" id="showProductContent">
		                {# Le contenu sera chargé dynamiquement via AJAX #}
		            </div>
		        </div>
		    </div>
		</div>
    

<!-- ... Autres parties du template ... -->

<!-- Modal de commande -->
<div class="modal fade" id="orderProductModal" tabindex="-1" aria-labelledby="orderProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header" style="background-color:rgb(195, 177, 229);">
                <h5 class="modal-title" id="orderProductModalLabel">
                    <i class="fas fa-shopping-cart me-2"></i>Passer commande
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="orderProductContent">
                <!-- Le contenu sera chargé dynamiquement ici -->
            </div>
        </div>
    </div>
</div>

<!-- ... Suite du template ... -->
		<!-- Footer / Contact -->
		
			<footer id="contact" class="contact" style="background-color: #e1bee7; color: black;">

    <div class="container"  style="color: black;">

        <div class="footer-top"   style="color: black;">
            <div class="row">
                <div class="col-md-3 col-sm-6">
                    <div class="single-footer-widget">
                        <div class="footer-logo">
                            <a href="index.html" style="font-size: 24px; font-weight: bold; color: black;">GYMTOWN</a>
                        </div>
                        <p style="color: black;">
                            Votre partenaire fitness et bien-être. Rejoignez notre communauté pour atteindre vos objectifs sportifs !
                        </p>
                        <div class="footer-contact">
                            <p style="color: black;">admin@gymtown.com</p>
                            <p style="color: black;">+216 95 443 345</p>
                        </div>
                    </div>
                </div>

                <div class="col-md-2 col-sm-6">
                    <div class="single-footer-widget">
                        <h2 style="color: black;">À propos</h2>
                        <ul>

                        
                            <li style="color: black;"><a href="{{ path('app_produituser_index') }}" style="color: black;">Nos produits</a></li>
                            <li style="color: black;"><a href="{{ path('app_commandeuser_index') }}" style="color: black;">Panier</a></li>
                            <li style="color: black;"><a href="#" style="color: black;">Nos salles de sport</a></li>
                            <li style="color: black;"><a href="#" style="color: black;">Notre cours</a></li>
                            <li style="color: black;"><a href="{{ path('app_client_events') }}" style="color: black;">Nos évenement</a></li>
                        </ul>
                    </div>
                </div>

                <div class="col-md-3 col-xs-12">
                    <div class="single-footer-widget">
                        <h2 style="color: black;">Activités</h2>
                        <div class="row">
                            <div class="col-md-7 col-xs-6">
                                <ul>
                                    <li style="color: black;"><a href="#" style="color: black;">Musculation</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">Cardio</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">CrossFit</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">Zumba</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">Yoga</a></li>
                                </ul>
                            </div>
                            <div class="col-md-5 col-xs-6">
                                <ul>
                                    <li style="color: black;"><a href="#" style="color: black;">Pilates</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">Boxe</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">Cycling</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">TRX</a></li>
                                    <li style="color: black;"><a href="#" style="color: black;">HIIT</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-offset-1 col-md-3 col-sm-6">
                    <div class="single-footer-widget">
                        <h2 style="color: black;">Newsletter</h2>
                        <div class="footer-newsletter">
                            <p style="color: black;">
                                Abonnez-vous pour recevoir les dernières actualités et offres spéciales !
                            </p>
                        </div>
                         <img src="{{ asset('img/GYM.png') }}" class="img-fluid logo-lg" alt="logo" style="display:block; width:1000px; length:1000px;">
                    </div>
                </div>
            </div>
        </div>

        <div class="footer-copyright">
            <div class="row">
                <div class="col-sm-6">
                    <p style="color: black;">
                        &copy; 2025 GYMTOWN. Tous droits réservés.
                    </p>
                </div>
                <div class="col-sm-6">
                    <div class="footer-social">
                        <a href="#"><i class="fa fa-facebook"></i></a>
                        <a href="#"><i class="fa fa-instagram"></i></a>
                        <a href="#"><i class="fa fa-youtube-play"></i></a>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="scroll-Top">
        <div class="return-to-top">
            <i class="fa fa-angle-up" id="scroll-top" data-bs-toggle="tooltip" data-bs-placement="top" title="Retour en haut"></i>
        </div>
    </div>
</footer>
		<!-- Fin Footer / Contact -->
{% endblock %}

<style>
 /* Supprimer la marge gauche de l'image */
  

   /* Menu fixe avec apparition au scroll */
   .navbar {
       position: fixed !important;
       top: 0;
       width: 100%;
       z-index: 1000;
       transition: transform 0.3s ease-in-out;
	    background-color: rgb(195, 177, 229); 
   }

   .navbar-hidden {
       transform: translateY(-100%);
   }

   .navbar-visible {
       transform: translateY(0);
   }

   /* Ajustement du contenu sous la navbar fixe */
   .container.py-5 {
       margin-top: 150px; /* Ajuster selon la hauteur de votre navbar */
   }
   /* Ajustement pour la navbar */
   .navbar-nav.ms-auto {
        margin-left: auto !important;
   }
   .navbar-nav {
        display: flex !important;
        flex-direction: row !important;
        align-items: center;
   }
   .navbar-nav > li {
        margin: 0 15px;
        position: relative;
   }
   .navbar-nav > li > a {
        padding: 15px 10px !important;
        text-transform: capitalize;
   }
   @media (max-width: 768px) {
        .navbar-nav {
            flex-direction: column !important;
            padding: 0;
        }
        .navbar-nav > li {
            margin: 3px 0;
            width: 100%;
            text-align: center;
        }
   }
</style>

{% block js %}
<script>
// Gestion du menu fixe
let lastScroll = 0;
const navbar = document.querySelector('.navbar');
const navbarHeight = navbar.offsetHeight;

window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;
    
    if (currentScroll > lastScroll && currentScroll > navbarHeight) {
        // Scroll vers le bas - cacher
        navbar.classList.add('navbar-hidden');
    } else {
        // Scroll vers le haut - afficher
        navbar.classList.remove('navbar-hidden');
        navbar.classList.add('navbar-visible');
    }
    
    lastScroll = currentScroll;
});
document.getElementById("searchAll").addEventListener("input", function () {
  const searchTerm = this.value.toLowerCase();
  const rows = document.querySelectorAll("#productTable");

  rows.forEach(row => {
    const rowText = row.textContent.toLowerCase();
    if (rowText.includes(searchTerm)) {
      row.style.display = "";
    } else {
      row.style.display = "none";
    }
  });
}); 
// Ajustement initial pour le contenu
document.addEventListener('DOMContentLoaded', () => {
    document.body.style.paddingTop = navbarHeight + 'px';
});
    document.addEventListener('DOMContentLoaded', () => {
    const prix = parseFloat(document.getElementById('prix').value);
    const quantiteInput = document.getElementById('commande_nombre');
    const totalOutput = document.getElementById('total');
    
    quantiteInput.addEventListener('input', () => {
        const quantite = parseInt(quantiteInput.value);
        const total = prix * quantite;
        totalOutput.value = total.toFixed(2) + ' DT';
    });
});

    function orderProduct(button) {
        const url = button.getAttribute('data-url');
        fetch(url)
            .then(response => response.text())
            .then(html => {
                document.getElementById('orderProductContent').innerHTML = html;
                const modal = new bootstrap.Modal(document.getElementById('orderProductModal'));
                modal.show();
                 initCommandeForm();
            })
            .catch(error => console.error('Error loading product:', error));
    }


function initCommandeForm() {
    const prix = parseFloat(document.getElementById('prix')?.value || 0);
    const quantiteInput = document.getElementById('commande_nombre');
    const totalOutput = document.getElementById('total');

    const updateTotal = () => {
        const quantite = parseInt(quantiteInput?.value) || 0;
        if(totalOutput) totalOutput.value = (prix * quantite).toFixed(2) + ' DT';
    };

    quantiteInput?.addEventListener('input', updateTotal);
    updateTotal();

    
}



    // Gestion dynamique de la suppression
    document.querySelectorAll('.delete-btn').forEach(button => {
        button.addEventListener('click', function() {
            const form = deleteModal.querySelector('form');
            form.action = this.dataset.url;
            form.querySelector('input[name="_token"]').value = this.dataset.token;
        });
    });

    function showProductDetails(button) {
        const url = button.getAttribute('data-url');
        fetch(url)
            .then(response => response.text())
            .then(html => {
                document.getElementById('showProductContent').innerHTML = html;
                const modal = new bootstrap.Modal(document.getElementById('showProductModal'));
                modal.show();
            })
            .catch(error => console.error('Error loading product:', error));
    }

    // Glisser-déposer pour un élément (exemple)
    let isDraggingTable = false;
    let startXTable, startYTable, initialXTable = 300, initialYTable = 180;

    const draggableTable = document.getElementById('draggableTable');
    if (draggableTable) {
        draggableTable.style.left = initialXTable + 'px';
        draggableTable.style.top = initialYTable + 'px';

        draggableTable.addEventListener('mousedown', startDraggingTable);
        document.addEventListener('mousemove', dragTable);
        document.addEventListener('mouseup', stopDraggingTable);

        // Événements pour le tactile
        draggableTable.addEventListener('touchstart', (e) => {
            startDraggingTable(e.touches[0]);
        });
        draggableTable.addEventListener('touchmove', (e) => {
            dragTable(e.touches[0]);
        });
        draggableTable.addEventListener('touchend', stopDraggingTable);
    }

    function startDraggingTable(e) {
        isDraggingTable = true;
        startXTable = e.clientX - initialXTable;
        startYTable = e.clientY - initialYTable;
        draggableTable.style.transition = 'none';
        draggableTable.classList.add('dragging');
    }
    function dragTable(e) {
        if (!isDraggingTable) return;
        const newX = e.clientX - startXTable;
        const newY = e.clientY - startYTable;
        const maxX = window.innerWidth - draggableTable.offsetWidth;
        const maxY = window.innerHeight - draggableTable.offsetHeight;
        initialXTable = Math.max(0, Math.min(newX, maxX));
        initialYTable = Math.max(0, Math.min(newY, maxY));
        draggableTable.style.left = initialXTable + 'px';
        draggableTable.style.top = initialYTable + 'px';
    }
    function stopDraggingTable() {
        isDraggingTable = false;
        if (draggableTable) {
            draggableTable.style.transition = 'transform 0.3s ease';
            draggableTable.classList.remove('dragging');
        }
    }
    function resetTablePosition() {
        initialXTable = 300;
        initialYTable = 180;
        if (draggableTable) {
            draggableTable.style.left = initialXTable + 'px';
            draggableTable.style.top = initialYTable + 'px';
        }
    }

    document.querySelectorAll('.show-modal-btn').forEach(btn => {
        btn.addEventListener('click', function () {
            const url = btn.getAttribute('data-url');
            fetch(url)
                .then(res => res.text())
                .then(html => {
                    document.getElementById('modalContent').innerHTML = html;
                    const modal = new bootstrap.Modal(document.getElementById('productModal'));
                    modal.show();
                });
        });
    });
</script>

<!-- Bootstrap 5 Bundle (incluant Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Vous pouvez retirer jQuery si vous n'en avez plus besoin dans vos scripts personnalisés -->
{% endblock %}
    </body>
</html>